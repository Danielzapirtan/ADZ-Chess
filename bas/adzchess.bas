10 REM Simple Chess for Minimal BASIC (No GOSUB)
20 REM Board: B[0-63], Pieces: 0=empty, 1-6=W pieces, 11-16=B pieces
30 REM 1/11=Pawn, 2/12=Knight, 3/13=Bishop, 4/14=Rook, 5/15=Queen, 6/16=King
40 DIM B[64]
50 DIM M[400]
60 REM Setup board
70 LET B[0]=14
80 LET B[1]=12
90 LET B[2]=13
100 LET B[3]=15
110 LET B[4]=16
120 LET B[5]=13
130 LET B[6]=12
140 LET B[7]=14
150 LET I=8
160 LET B[I]=11
170 LET I=I+1
180 IF I<16 THEN 160
190 LET I=16
200 LET B[I]=0
210 LET I=I+1
220 IF I<48 THEN 200
230 LET I=48
240 LET B[I]=1
250 LET I=I+1
260 IF I<56 THEN 240
270 LET B[56]=4
280 LET B[57]=2
290 LET B[58]=3
300 LET B[59]=5
310 LET B[60]=6
320 LET B[61]=3
330 LET B[62]=2
340 LET B[63]=4
350 LET T=1
360 PRINT "BASIC Chess Engine"
370 PRINT " "
380 REM Display board
390 PRINT "  0 1 2 3 4 5 6 7"
400 LET R=0
410 PRINT R;": ";
420 LET C=0
430 LET SQ=R*8+C
440 LET P=B[SQ]
450 IF P=0 THEN 620
460 IF P=1 THEN PRINT "P ";
470 IF P=2 THEN PRINT "N ";
480 IF P=3 THEN PRINT "B ";
490 IF P=4 THEN PRINT "R ";
500 IF P=5 THEN PRINT "Q ";
510 IF P=6 THEN PRINT "K ";
520 IF P=11 THEN PRINT "p ";
530 IF P=12 THEN PRINT "n ";
540 IF P=13 THEN PRINT "b ";
550 IF P=14 THEN PRINT "r ";
560 IF P=15 THEN PRINT "q ";
570 IF P=16 THEN PRINT "k ";
580 LET C=C+1
590 IF C<8 THEN 430
600 PRINT " "
610 GOTO 630
620 PRINT ". ";
625 GOTO 580
630 LET R=R+1
640 IF R<8 THEN 410
650 PRINT " "
660 REM Game turn
670 IF T=1 THEN 710
680 PRINT "Black (Computer) move"
690 GOTO 1000
710 PRINT "White (Human) move"
720 PRINT "From square (0-63):"
730 INPUT F
740 PRINT "To square (0-63):"
750 INPUT D
760 LET P=B[F]
770 IF P=0 THEN 720
780 IF P>10 THEN 720
790 REM Make move
800 LET B[D]=P
810 LET B[F]=0
820 LET T=0
830 GOTO 380
1000 REM Computer finds move
1010 LET MC=0
1020 LET I=0
1030 LET P=B[I]
1040 IF P<11 THEN 1850
1050 IF P>16 THEN 1850
1060 REM Check piece type and generate moves
1070 IF P=11 THEN 1100
1075 IF P=12 THEN 1300
1077 IF P=13 THEN 1500
1078 IF P=14 THEN 1500
1079 IF P=15 THEN 1500
1080 IF P=16 THEN 1700
1085 GOTO 1850
1100 REM Black Pawn at I
1110 LET D=I+8
1120 IF D>63 THEN 1850
1130 IF B[D]=0 THEN 1260
1140 LET D=I+7
1150 IF D>63 THEN 1850
1160 IF B[D]=0 THEN 1850
1170 IF B[D]>10 THEN 1850
1180 LET M[MC]=I
1190 LET MC=MC+1
1200 LET M[MC]=D
1210 LET MC=MC+1
1220 GOTO 1850
1260 LET M[MC]=I
1270 LET MC=MC+1
1280 LET M[MC]=D
1290 LET MC=MC+1
1295 GOTO 1140
1300 REM Knight at I - try all 8 moves
1310 LET K=0
1320 LET D=I-17
1330 IF K=1 THEN D=I-15
1335 IF K=2 THEN D=I-10
1340 IF K=3 THEN D=I-6
1345 IF K=4 THEN D=I+6
1350 IF K=5 THEN D=I+10
1355 IF K=6 THEN D=I+15
1360 IF K=7 THEN D=I+17
1370 IF D<0 THEN 1470
1380 IF D>63 THEN 1470
1390 LET RR=I/8
1400 LET RC=I-RR*8
1410 LET NR=D/8
1420 LET NC=D-NR*8
1425 LET DR=NR-RR
1426 LET DC=NC-RC
1427 IF DR<0 THEN DR=0-DR
1428 IF DC<0 THEN DC=0-DC
1429 IF DR+DC<>3 THEN 1470
1430 IF B[D]>10 THEN 1470
1440 LET M[MC]=I
1450 LET MC=MC+1
1460 LET M[MC]=D
1465 LET MC=MC+1
1470 LET K=K+1
1480 IF K<8 THEN 1320
1490 GOTO 1850
1500 REM Rook/Bishop/Queen - just pick simple moves
1510 LET D=I+1
1520 IF D>63 THEN 1850
1530 LET RR=I/8
1540 LET NR=D/8
1545 IF RR<>NR THEN 1850
1550 IF B[D]=0 THEN 1620
1560 IF B[D]<11 THEN 1620
1570 LET D=I-1
1580 IF D<0 THEN 1850
1590 IF B[D]=0 THEN 1620
1600 IF B[D]>10 THEN 1850
1620 LET M[MC]=I
1630 LET MC=MC+1
1640 LET M[MC]=D
1650 LET MC=MC+1
1660 GOTO 1850
1700 REM King - try 8 directions
1710 LET K=0
1720 LET DR=0-1
1725 LET DC=0
1730 IF K=1 THEN DR=1
1732 IF K=1 THEN DC=0
1735 IF K=2 THEN DR=0
1737 IF K=2 THEN DC=0-1
1740 IF K=3 THEN DR=0
1742 IF K=3 THEN DC=1
1745 IF K=4 THEN DR=0-1
1747 IF K=4 THEN DC=0-1
1750 IF K=5 THEN DR=0-1
1752 IF K=5 THEN DC=1
1755 IF K=6 THEN DR=1
1757 IF K=6 THEN DC=0-1
1760 IF K=7 THEN DR=1
1762 IF K=7 THEN DC=1
1770 LET RR=I/8
1780 LET RC=I-RR*8
1790 LET NR=RR+DR
1800 LET NC=RC+DC
1810 IF NR<0 THEN 1840
1815 IF NR>7 THEN 1840
1820 IF NC<0 THEN 1840
1825 IF NC>7 THEN 1840
1830 LET D=NR*8+NC
1832 IF B[D]<11 THEN 1620
1840 LET K=K+1
1842 IF K<8 THEN 1720
1850 LET I=I+1
1860 IF I<64 THEN 1030
1870 REM Pick move
1880 IF MC<2 THEN 9000
1890 LET F=M[0]
1900 LET D=M[1]
1910 LET P=B[F]
1920 PRINT "Computer: ";F;" to ";D
1930 LET B[D]=P
1940 LET B[F]=0
1950 LET T=1
1960 GOTO 380
9000 PRINT "No moves - Game Over"
9010 END
